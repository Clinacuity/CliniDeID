<?xml version="1.0" encoding="UTF-8"?>
<!--from v09f-->

<conceptSet xmlns="http://incubator.apache.org/uima/regex">
    <variables>
        <variable name="separator" value="\s{1,3}"/>
        <variable name="sepOPT" value="\s{0,3}"/>
    </variables>

    <concept name="holidayDetection" processAllRules="true">
        <rules>
            <!-- christmas could be a name or city so day is required, valentine could be a person so require 's and day-->
            <rule ruleId="holidayList"
                  regEx="\b(?i)(?:new\s+years(?:\s+day)?|martin\s+luther\s+king'?s?(?:\s+day)?|martin\s+luther\s+king\s+jr(?:\s+day)?|valentine's\s+day|president's\s+day|st\.?\s+patrick's\s+day|palm\s+sunday|good\s+friday|passover|easter|confederate\s+memorial\s+day|cinco\s+de\s+mayo|mother's\s+day|ramadan|memorial\s+day|flag\s+day|father's\s+day|independence\s+day|labor\s+day|rosh\s+hashana|yom\s+kippur|columbus\s+day|halloween|all\s+saint's\s+day|all\s+soul's:\s+day|veteran's\s+day|thanksgiving|hanukkah|chanukah|christmas\s+eve|christmas day)\b"
                  matchStrategy="matchAll" matchType="uima.tcas.DocumentAnnotation"
                  confidence="1.0"/>
        </rules>
        <createAnnotations>
            <annotation id="holidayAnnot" type="com.clinacuity.deid.type.PiiAnnotation">
                <begin group="0"/>
                <end group="0"/>
                <setFeature name="confidence" type="Confidence"/>
                <setFeature name="piiSubtype" type="String">Date</setFeature>
                <setFeature name="piiType" type="String">TEMPORAL</setFeature>
                <setFeature name="method" type="String">Regex</setFeature>
            </annotation>
        </createAnnotations>
    </concept>

    <!-- CONCEPT FOR PHI TYPE AGE -->
    <concept name="ageDetection" processAllRules="true">
        <rules>
            <!--fifities ... could be date, trying to get 49y7.7m-->
            <rule ruleId="specialAges"
                  regEx="\b(?i)(tween|teenagers?|pre-?teens?|twenties|thirties|\d+y\d+\.\d+m)\b"
                  matchStrategy="matchAll" matchType="uima.tcas.DocumentAnnotation"
                  confidence="1.0"/>
        </rules>
        <createAnnotations>
            <annotation id="ageAnnot" type="com.clinacuity.deid.type.PiiAnnotation">
                <begin group="0"/>
                <end group="0"/>
                <setFeature name="confidence" type="Confidence"/>
                <setFeature name="piiSubtype" type="String">Age</setFeature>
                <setFeature name="piiType" type="String">TEMPORAL</setFeature>
                <setFeature name="method" type="String">Regex</setFeature>
            </annotation>
        </createAnnotations>
    </concept>

    <!-- CONCEPT FOR PHI TYPE DayOfWeek -->
    <concept name="dayOfWeekDetection" processAllRules="true">
        <rules>
            <!-- sat is too often saturation level or 'sat up', even if capitalized, sun can be sun exposure, mon can be???-->
            <rule ruleId="dayOfWeekAbbreviation"
                  regEx="\b(?i)(mon|tues?|wed|thu|thurs?|fri|sun|monday|tuesday|wednesday|thursday|friday|saturday|sunday)\b"
                  matchStrategy="matchAll" matchType="uima.tcas.DocumentAnnotation"
                  confidence="1.0"/>
        </rules>
        <createAnnotations>
            <annotation id="dayofWeekAnnot" type="com.clinacuity.deid.type.PiiAnnotation">
                <begin group="0"/>
                <end group="0"/>
                <setFeature name="confidence" type="Confidence"/>
                <setFeature name="piiSubtype" type="String">DayOfWeek</setFeature>
                <setFeature name="piiType" type="String">TEMPORAL</setFeature>
                <setFeature name="method" type="String">Regex</setFeature>
            </annotation>
        </createAnnotations>
    </concept>

    <!-- CONCEPT FOR PHI TYPE SSN -->
    <concept name="ssnDetection" processAllRules="true">
        <rules>
            <!-- should we relax \b requirement and use \D instead (w/o \D many 10 digit phone numbers would contain the 9 digit SSN-->
            <rule ruleId="mit-ssn"
                  regEx="\b(?i)(?&lt;!MRN?#?\s{0,6}:?\s{0,6})(\d\d\d([- \/]?)\d\d\2\d\d\d\d)\b"
                  matchStrategy="matchAll" matchType="uima.tcas.DocumentAnnotation"
                  confidence="0.8"/>
        </rules>
        <createAnnotations>
            <annotation id="ssnAnnot" type="com.clinacuity.deid.type.PiiAnnotation">
                <begin group="0"/>
                <end group="0"/>
                <setFeature name="confidence" type="Confidence"/>
                <setFeature name="piiSubtype" type="String">SSN</setFeature>
                <setFeature name="piiType" type="String">IDENTIFIER</setFeature>
                <setFeature name="method" type="String">Regex</setFeature>
            </annotation>
        </createAnnotations>
    </concept>

    <concept name="hcuDetection" processAllRules="true">
        <rules>
            <!-- below memorial hospital currently makes no difference to FP or FN, trying community and CapitalizedWords Hospital-->
            <rule ruleId="hcu-weak"
                  regEx="\b(?:[A-Z][a-z]+'?s?\s+)+Hospital\b"
                  matchStrategy="matchAll" matchType="uima.tcas.DocumentAnnotation"
                  confidence="0.3"/>
        </rules>
        <createAnnotations>
            <annotation id="hcuAnnot" type="com.clinacuity.deid.type.PiiAnnotation">
                <begin group="0"/>
                <end group="0"/>
                <setFeature name="confidence" type="Confidence"/>
                <setFeature name="piiSubtype" type="String">HealthCareUnitName</setFeature>
                <setFeature name="piiType" type="String">LOCATION</setFeature>
                <setFeature name="method" type="String">Regex</setFeature>
            </annotation>
        </createAnnotations>
    </concept>

    <!-- CONCEPT FOR PHI TYPE ELECTRONICADDRESS (Detection of emails) -->
    <concept name="emailDetection" processAllRules="true">
        <rules>

            <rule ruleId="default-email"
                  regEx="([a-zA-Z0-9!#$%*+'/=?^_\x2D`{|}~.\x26]+)@([a-zA-Z0-9._-]+[a-zA-Z]{2,4})"
                  matchStrategy="matchAll" matchType="uima.tcas.DocumentAnnotation"
                  confidence="0.5"/>

            <rule ruleId="mit-email"
                  regEx="\b[\w\.]+\w ?@ ?\w+[\.\w+]\.\w{2,3}\b"
                  matchStrategy="matchAll" matchType="uima.tcas.DocumentAnnotation"
                  confidence="0.5"/>
            <!--
                        <rule ruleId="hms-email"
                              regEx="\b([a-zA-Z0-9_\-])+(\.([a-zA-Z0-9_\-])+)*@((\[(((([0-1])?([0-9])?[0-9])|(2[0-4][0-9])|(2[0-5][0-5])))\.(((([0-1])?([0-9])?[0-9])|(2[0-4][0-9])|(2[0-5][0-5])))\.(((([0-1])?([0-9])?[0-9])|(2[0-4][0-9])|(2[0-5][0-5])))\.(((([0-1])?([0-9])?[0-9])|(2[0-4][0-9])|(2[0-5][0-5]))\]))|((([a-zA-Z0-9])+(([\-])+([a-zA-Z0-9])+)*\.)+([a-zA-Z])+(([\-])+([a-zA-Z0-9])+)*))\b"
                              matchStrategy="matchAll" matchType="uima.tcas.DocumentAnnotation"
                              confidence="0.5"/>
            this was replaced with below for readability
            -->
            <rule ruleId="hms-email"
                  regEx="\b([\w\-])+(\.([\w\-])+)*@([01]?\d?\d|2[0-4]\d|25[0-5])(\.(([01]?\d?\d)|(2[0-4]\d)|(25[0-5]))){3}\b"
                  matchStrategy="matchAll" matchType="uima.tcas.DocumentAnnotation"
                  confidence="0.5"/>

            <rule ruleId="meds-email"
                  regEx="\b(\S+@\S+\.\S+)\b"
                  matchStrategy="matchAll" matchType="uima.tcas.DocumentAnnotation"
                  confidence="0.5"/>

        </rules>
        <createAnnotations>
            <annotation id="emailAnnot" type="com.clinacuity.deid.type.PiiAnnotation">
                <begin group="0"/>
                <end group="0"/>
                <setFeature name="confidence" type="Confidence"/>
                <setFeature name="piiSubtype" type="String">ElectronicAddress</setFeature>
                <setFeature name="piiType" type="String">CONTACT_INFORMATION</setFeature>
                <setFeature name="method" type="String">Regex</setFeature>
            </annotation>
        </createAnnotations>
    </concept>


    <!-- CONCEPT FOR PHI TYPE ELECTRONICADDRESS (Detection of URLs) -->
    <concept name="URLDetection" processAllRules="true">
        <rules>
<!-- missed: http://olin.msu.edu/p/EBN-2006-09-13-nasal-flu-vaccine-beats-shots-for-young-children.html issue with confidence level?-->
            <rule ruleId="mit-from-all-url-regex"
                  regEx="\b([hH][Tt][Tt][Pp][Ss]?\:\/\/|[Ff][Tt][Pp]\:\/\/|[Ww][Ww][Ww]\.|[Ww][Ee][Bb]\.)[^\s]+"
                  matchStrategy="matchAll" matchType="uima.tcas.DocumentAnnotation"
                  confidence="0.5"/>

            <!-- original mit rules for urls -->
            <rule ruleId="mit-url-1"
                  regEx="\bhttps?\:\/\/[\w\.]+\w{2,4}\/\S+\b"
                  matchStrategy="matchAll" matchType="uima.tcas.DocumentAnnotation"
                  confidence="0.5"/>
            <rule ruleId="mit-url-2"
                  regEx="\bftp\:\/\/[\w\.]+\w{2,4}\/\S+\b"
                  matchStrategy="matchAll" matchType="uima.tcas.DocumentAnnotation"
                  confidence="0.5"/>
            <rule ruleId="mit-url-3"
                  regEx="\bwww\.[\w\.]+\w{2,4}\/\S+\b"
                  matchStrategy="matchAll" matchType="uima.tcas.DocumentAnnotation"
                  confidence="0.5"/>
            <rule ruleId="mit-url-4"
                  regEx="\bwww\.[\w\.]+\w{2,4}\b"
                  matchStrategy="matchAll" matchType="uima.tcas.DocumentAnnotation"
                  confidence="0.5"/>
            <rule ruleId="mit-url-5"
                  regEx="\bweb\.[\w\.]+\w{2,4}\/\S+\b"
                  matchStrategy="matchAll" matchType="uima.tcas.DocumentAnnotation"
                  confidence="0.5"/>
            <rule ruleId="mit-url-6"
                  regEx="\bweb\.[\w\.]+\w{2,4}\b"
                  matchStrategy="matchAll" matchType="uima.tcas.DocumentAnnotation"
                  confidence="0.5"/>
            <rule ruleId="mit-url-7"
                  regEx="\bhttps?\:\/\/[\w\.]+\w{2,4}\b"
                  matchStrategy="matchAll" matchType="uima.tcas.DocumentAnnotation"
                  confidence="0.5"/>
            <rule ruleId="mit-url-8"
                  regEx="\bftp\:\/\/[\w\.]+\w{2,4}\b"
                  matchStrategy="matchAll" matchType="uima.tcas.DocumentAnnotation"
                  confidence="0.5"/>

            <!-- dot comS or govS, no www or other -->
            <rule ruleId="va-9"
                  regEx="\b([A-Za-z]+\.(com|gov))\b"
                  matchStrategy="matchAll" matchType="uima.tcas.DocumentAnnotation"
                  confidence="0.5"/>

        </rules>
        <createAnnotations>
            <annotation id="URLAnnot" type="com.clinacuity.deid.type.PiiAnnotation">
                <begin group="0"/>
                <end group="0"/>
                <setFeature name="confidence" type="Confidence"/>
                <setFeature name="piiSubtype" type="String">ElectronicAddress</setFeature>
                <setFeature name="piiType" type="String">CONTACT_INFORMATION</setFeature>
                <setFeature name="method" type="String">Regex</setFeature>
            </annotation>
        </createAnnotations>
    </concept>


    <!-- CONCEPT FOR PHI TYPE ELECTRONICADDRESS (Detection of IP addresses) -->
    <concept name="IPDetection" processAllRules="true">
        <rules>
            <rule ruleId="hms-IP"
                  regEx="\b(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9])\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[0-9])\b"
                  matchStrategy="matchAll" matchType="uima.tcas.DocumentAnnotation"
                  confidence="0.5"/>
        </rules>
        <createAnnotations>
            <annotation id="IPAnnot" type="com.clinacuity.deid.type.PiiAnnotation">
                <begin group="0"/>
                <end group="0"/>
                <setFeature name="confidence" type="Confidence"/>
                <setFeature name="piiSubtype" type="String">ElectronicAddress</setFeature>
                <setFeature name="piiType" type="String">CONTACT_INFORMATION</setFeature>
                <setFeature name="method" type="String">Regex</setFeature>
            </annotation>
        </createAnnotations>
    </concept>

</conceptSet>
